generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Experience {
  id          Int      @id @default(autoincrement())
  title       String
  description String
  price       Float
  imageUrl    String
  location    String
  duration    String
  category    String
  rating      Float?
  reviewCount Int      @default(0)
  slots       Slot[]
  bookings    Booking[]
  createdAt   DateTime @default(now())
}

model Slot {
  id             Int       @id @default(autoincrement())
  experienceId   Int
  date           DateTime
  startTime      String
  endTime        String
  availableSeats Int       @default(10)
  experience     Experience @relation(fields: [experienceId], references: [id])
  bookings       Booking[]
  createdAt      DateTime  @default(now())
}

model Booking {
  id             Int      @id @default(autoincrement())
  experienceId   Int
  slotId         Int
  customerName   String
  customerEmail  String
  customerPhone  String?
  guests         Int      @default(1)
  totalPrice     Float
  promoCode      String?
  discountAmount Float    @default(0)
  finalPrice     Float
  status         String   @default("confirmed")
  experience     Experience @relation(fields: [experienceId], references: [id])
  slot           Slot     @relation(fields: [slotId], references: [id])
  createdAt      DateTime @default(now())
}

model PromoCode {
  id          Int      @id @default(autoincrement())
  code        String   @unique
  discountType String  // 'percentage' or 'fixed'
  discountValue Float
  minAmount    Float?
  maxDiscount  Float?
  validFrom    DateTime
  validUntil   DateTime
  isActive     Boolean @default(true)
  usageLimit   Int?
  usedCount    Int     @default(0)
}